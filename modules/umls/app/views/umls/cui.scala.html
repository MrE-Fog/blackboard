@import blackboard.umls.UMLSKSource
@import blackboard.umls.Concept
@(concept: Concept, ks: UMLSKSource)

@views.html.core.main(concept.name+" ("+concept.cui+")"){
<div class="container-fluid" style="margin-top:10px;">
  <div class="jumbotron">
    <h1 class="display-4">@displayconcept(concept, ks)</h1>
    @if(!concept.definitions.isEmpty) {
      @defining(concept.definitions(0)) { d =>
      <p class="lead">@HtmlFormat.raw(d.description)
      <span data-toggle="tooltip" title="@ks.getDataSources(d.source)(0).description">[@d.source]</span></p>
      }
      @if(concept.definitions.size > 1) {
    <p class="lead">
      <a class="btn btn-primary" data-toggle="collapse"
         href="#definition-card" role="button"
         aria-expanded="false" aria-controls="definition-card">
        Additional definitions</a>
    </p>
    <div class="collapse" id="definition-card">
      <div class="card card-body">
        @for(i <- 1 until concept.definitions.size) {
          @defining(concept.definitions(i)) { d =>
            <p>@HtmlFormat.raw(d.description) <span data-toggle="tooltip" title="@ks.getDataSources(d.source)(0).description">[@d.source]</span></p>
          }
        }
      </div>
    </div>
    <br>
      }
    }
    @if(!concept.semanticTypes.isEmpty) {
      <p class="lead">
      @for(st <- concept.semanticTypes) {
        <span class="badge badge-pill badge-primary">@st.name</span>
      }
      </p>
    }
  </div>
  <div class="card">
    <h5 class="card-header">Synonyms</h5>
    <div class="card-body">
      <table class="table" id="table-synonym"
             data-page-length="5" width="100%">
        <thead>
          <tr>
            <th>Name</th>
            <th>Source</th>
          </tr>
        </thead>
        <tbody>
          @for(syn <- concept.synonyms) {
            <tr>
              @if("MSH".equalsIgnoreCase(syn.source.name)) {
              <td><a href="@controllers.mesh.routes.Controller.mesh(syn.source.conceptUI)">@syn.name</a></td>
              } else {
              <td>@syn.name</td>
              }
              <td><span data-toggle="tooltip"
                        title="@ks.getDataSources(syn.source.name)(0).description">@syn.source.name</span></td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
  <br>
  <div class="card">
    <h5 class="card-header">Relationships</h5>
    <div class="card-body">
    </div>
  </div>
  <br>
</div>
}(HtmlFormat.empty){
    $(document).ready(function () {
        $('[data-toggle="tooltip"]').tooltip();
        $('#table-synonym').DataTable({
            order: false,
            dom: '<"pull-left"f>pit'
        });
        $('table[id|="table"]').on('draw.dt', function () {
            $('[data-toggle="tooltip"]').tooltip();
        });
        
    });
}

